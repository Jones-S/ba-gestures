<!doctype html>
<html>

<head>
    <title>Receive Socket.io</title>
    <link href='https://fonts.googleapis.com/css?family=Fira+Mono:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="css/receive.css" />
</head>

<body>
    <div id="messages">Here will be a message.</div>
<!--     <canvas id="canvas"></canvas>
 -->    <script src="/socket.io/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <script src="bower_components/typed.js/dist/typed.min.js"></script>
    <script>
    var socket = io();

    var $el = $('#messages');
    var alpha = 0;


    socket.on('chat message', function(msg) {
        console.log("receiving a chat message.");
        // check if body is empty
        if ($('body').children().length > 0) {
            // if not empty it
            $('body').empty();
        }

        $el = $('<div id="messages"></div>');
        $('body').append($el);
        // $el.text(msg);
        $el.typed({
            strings: [msg],
            typeSpeed: 0
        });
    });

    // receive image
    socket.on("image", function(img_source) {
        console.log("image receiving");
        // empty body tag
        $( 'body' ).empty();
        // add container for div
        $('body').append('<div id="img-container" class="img-container"></div>');
        $('<img class="img-fullscreen" src="'+ img_source +'">').load(function() {
            $(this).appendTo('#img-container');
        });

    });

    // receive brightness command
    socket.on("brightness", function(cmd) {
        console.log("cmd: " + cmd);
        calc_alpha(cmd); // calc new alpha
        if(cmd == "increase") {
            $('body').css('background-color', 'rgba( 0, 0 ,0, ' + alpha + ')');
        } else {
            $('body').css('background-color', 'rgba( 0, 0 ,0, ' + alpha + ')');
        }

    });


    function calc_alpha(cmd) {
        if (cmd == "decrease") {
            if (alpha < 1) {
                alpha += 0.05;
            }
        } else {
            if (alpha > 0) {
                alpha -= 0.05;
            }
        }
    }
    </script>
</body>

</html>