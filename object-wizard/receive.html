<!doctype html>
<html>

<head>
    <title>Receive Socket.io</title>
    <link href='https://fonts.googleapis.com/css?family=Fira+Mono:400,700' rel='stylesheet' type='text/css'>
    <style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font: 80px 'Fira Mono', Helvetica, Arial;
        min-height: 600px;
    }

    #messages {
        list-style-type: none;
        margin: 0;
        padding: 30px;
        padding-right: 100px;
        padding-top: 70px;
    }

    #messages li {
        padding: 5px 10px;
    }

    #messages li:nth-child(odd) {
        background: #eee;
    }

    .typed-cursor {
        display: none;
    }
    </style>
</head>

<body>
    <div id="messages">Here will be a message.</div>
<!--     <canvas id="canvas"></canvas>
 -->    <script src="/socket.io/socket.io.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.1.js"></script>
    <script src="bower_components/typed.js/dist/typed.min.js"></script>
    <script>
    var socket = io();

    var $el = $('#messages');


    socket.on('chat message', function(msg) {
        console.log("receiving a chat message.");
        // check if body is empty
        if ($('body').children().length > 0) {
            // if not empty it
            $('body').empty();
        }

        $el = $('<div id="messages"></div>');
        $('body').append($el);
        // $el.text(msg);
        $el.typed({
            strings: [msg],
            typeSpeed: 0
        });
    });

    // receive image
    socket.on("image", function(info) {
        console.log("image receiving");
        if (info.image) {
            // empty body tag
            $( 'body' ).empty();
            // get width and height of window to draw canvas fullscreen
            var w_width = $( window ).width();
            var w_height = $( window ).height();
            // and add image in canvas
            $('body').append('<canvas id="canvas" width="' + w_width + '" height="' + w_height + '"></canvas>');
            // reassign ctx
            var ctx = document.getElementById('canvas').getContext('2d');
            var img = new Image();
            img.src = 'data:image/jpeg;base64,' + info.buffer;
            ctx.drawImage(img, 0, 0, w_width, w_width * img.height / img.width);
        }
    });
    </script>
</body>

</html>